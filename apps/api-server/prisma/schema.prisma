generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

enum PublishStatus {
  draft
  published
  archived
}

model User {
  id           Int       @id @default(autoincrement())
  email        String    @unique
  passwordHash String
  name         String
  createdAt    DateTime  @default(now())
  updatedAt    DateTime  @updatedAt
  sessions     Session[]
}

model Session {
  id        Int      @id @default(autoincrement())
  userId    Int
  tokenHash String   @unique
  expiresAt DateTime
  createdAt DateTime @default(now())
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([expiresAt])
}

model Post {
  id              Int           @id @default(autoincrement())
  title           String
  slug            String        @unique
  excerpt         String?
  content         String
  status          PublishStatus @default(draft)
  featuredImageId Int?
  publishedAt     DateTime?
  createdAt       DateTime      @default(now())
  updatedAt       DateTime      @updatedAt
  featuredImage   Media?        @relation(fields: [featuredImageId], references: [id], onDelete: SetNull)

  @@index([status])
  @@index([createdAt])
}

model Page {
  id          Int           @id @default(autoincrement())
  title       String
  slug        String        @unique
  content     String
  status      PublishStatus @default(draft)
  publishedAt DateTime?
  createdAt   DateTime      @default(now())
  updatedAt   DateTime      @updatedAt

  @@index([status])
  @@index([createdAt])
}

model Media {
  id           Int      @id @default(autoincrement())
  filename     String
  originalName String
  mimeType     String
  size         Int
  width        Int?
  height       Int?
  altText      String?
  path         String
  url          String
  createdAt    DateTime @default(now())
  posts        Post[]

  @@index([createdAt])
}

model Setting {
  key       String   @id
  value     String
  updatedAt DateTime @updatedAt
}
